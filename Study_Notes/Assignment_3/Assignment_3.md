# Introduction

In this project, I use the ns-3 simulator to create a network that consists of an Access Point (AP) and three stations (STAs). The AP and the STAs are configured to operate using the IEEE 802.11 standard with Quality of Service (QoS) support, specifically utilizing the 802.11e TXOP (Transmission Opportunity) mechanism. Each station continuously transmits data packets to the AP, simulating a network environment where different types of traffic (voice, video, and best effort) compete for bandwidth.

The goal of this simulation is to replicate the results obtained in a referenced research paper. The research paper analyzes the performance of a network under varying traffic loads and measures the throughput achieved by each traffic category. 

This project can be divided into 2 main parts, the first part is the implementation of the simulation. And the second part is the analysis of the results generated by the simulator.


# Implementation of the Simulator

The implementation of the ns3 simulator can be done either on python or in C++. I decided to implement it using C++ since I found more examples scripts on C++ in the examples provided by ns3.

The implementation can be divided into simulation set-up, network set-up, QoS parameters configuration and output of results.

### Simulation Set-Up

In the simulation setup, I initialize various parameters required for the simulation. These include setting the port number, payload size, traffic start and end times, and traffic increment values. Additionally, the csv output file is opened for logging the simulation results.

### Network Set-Up

The network is composed of one Access Point (AP) and four stations (STAs). Each station represents a different Access Category (AC): Voice (AC_VO), Video (AC_VI), Best Effort (AC_BE), and Background (AC_BK). These stations continuously transmit data packets to the AP.

```
Network topology :

//             AP
//   *---------*----------*----------*
//   |         |          |          |        
//  STA A     STA B     STA C     STA D

```

### QoS Parameters 

The QoS parameters for each AC are configured based on the values provided by the research paper. These parameters include the Arbitration Inter-Frame Space (AIFS), the minimum contention window size (CWmin) and the maximum contention window sizes (CWmax).


Values utlize in research paper:

![image](https://github.com/bmw-ece-ntust/multimedia-wireless-network/assets/133529935/f3f01e75-8aca-427e-af0d-c0e3b2eac9d3)

### Output the Results

The simulation is run a total of 5 times and each time the results of the simulation are saved into a different csv file for further analysis. Also, on each simualation the results are printed on the console as they are generated.

Example of CSV file generated:

| Current Traffic (Mbps) | Throughput AC_VO (Mbps) | Throughput AC_VI (Mbps) | Throughput AC_BE (Mbps) | Throughput AC_BK (Mbps) |
|------------------------|-------------------------|-------------------------|-------------------------|-------------------------|
| 1                      | 0.541696                | 0.47104                 | 0.486741                | 0.514219                |
| 4                      | 1.59761                 | 1.89201                 | 2.19034                 | 2.03725                 |
| 7                      | 3.59168                 | 3.21092                 | 3.5485                  | 3.65056                 |
| 10                     | 4.41993                 | 5.46799                 | 4.59657                 | 4.87919                 |
| 13                     | 6.35904                 | 6.40614                 | 7.28934                 | 5.89585                 |
| 16                     | 8.33741                 | 7.71721                 | 7.19906                 | 7.34037                 |
| 19                     | 10.1313                 | 9.51893                 | 9.29519                 | 4.27076                 |
| 22                     | 11.3599                 | 10.9595                 | 9.42473                 | 2.80269                 |
| 25                     | 11.9134                 | 13.0321                 | 10.6808                 | 0.329728                |
| 28                     | 12.93                   | 12.7887                 | 10.3472                 | 0.149163                |
| 31                     | 8.97331                 | 15.9212                 | 10.618                  | 0.439637                |




# Analysis of Results

As mentioned previously, the results of the simulations are saved into CSV files. To analyze these results, a Python script is utilized. First, the script calculates the average value of all the simulations. This average calculation is performed to provide a more representative view of the system's performance across multiple simulations. By averaging the results of multiple simulations, the script mitigates the impact of any or variability that may appear in individual simulation runs. This approach helps to smooth out fluctuations and provides a more stable representation of the network behavior.

After calculating the average data, the script utilizes the Matplotlib library to create a graph showing how the throughput of the Access Category (AC) types changes as the traffic increases. The graph allows for a visual understanding of how the system's throughput responds to increasing traffic loads across different ACs. This analysis is crucial for evaluating the network's performance and understanding how different types of traffic are prioritized and handled under varying traffic conditions.

### Python Code for Creating the Graph

```python

import csv
import matplotlib.pyplot as plt
import numpy as np

def read_csv(filename):
    data = {'x': [], 'vi': [], 'vo': [], 'be': [], 'bk': []}
    with open(filename, 'r') as file:
        reader = csv.reader(file)
        for row in reader:
            data['x'].append(float(row[0]))  # Current Traffic AC
            data['vi'].append(float(row[1]))  # Throughput AC_VI
            data['vo'].append(float(row[2]))  # Throughput AC_VO
            data['be'].append(float(row[3]))  # Throughput AC_BE
            data['bk'].append(float(row[4]))  # Throughput AC_BK
    return data

def average_data(data_list):
    # Find the minimum length among all datasets
    min_length = min(len(data['x']) for data in data_list)
    
    # Initialize an empty dictionary to store the sum of each data point
    sum_data = {'x': [0] * min_length, 'vi': [0] * min_length, 'vo': [0] * min_length, 'be': [0] * min_length, 'bk': [0] * min_length}
    
    # Iterate over each dataset and add up the corresponding data points
    for data in data_list:
        for key in sum_data:
            sum_data[key] = [sum_data[key][i] + data[key][i] for i in range(min_length)]
    
    # Calculate the average by dividing each sum by the number of datasets
    num_datasets = len(data_list)
    avg_data = {key: [value / num_datasets for value in sum_data[key]] for key in sum_data}
    
    return avg_data


def plot_graph(data):
    plt.figure(facecolor='black')
    ax = plt.gca()
    ax.set_facecolor('black')
    
    plt.plot(data['x'], data['vi'], label='AC_VI', color='blue')
    plt.plot(data['x'], data['vo'], label='AC_VO', color='green')
    plt.plot(data['x'], data['be'], label='AC_BE', color='red')
    plt.plot(data['x'], data['bk'], label='AC_BK', color='grey')
    
    plt.title('Average Throughput per AC with increasing offered traffic per AC', color='white')
    
    plt.xlabel('Current Traffic AC', color='white')
    plt.ylabel('Throughput (Mbps)', color='white')
    
    plt.legend()
    plt.grid(True, color='gray')
    
    ax.tick_params(axis='x', colors='white')
    ax.tick_params(axis='y', colors='white')
    
    plt.show()

if __name__ == "__main__":
    # List of filenames for all simulation outputs
    filenames = [f"/home/f11215125/Desktop/ns-allinone-3.41/ns-3.41/my_output/simulation_output_0{i}.csv" for i in range(1, 6)]
    
    # Read data from all CSV files
    data_list = [read_csv(filename) for filename in filenames]
    
    # Compute the average data
    avg_data = average_data(data_list)
    
    # Plot the average data
    plot_graph(avg_data)

```

# Conclusion

## Research Paper Results

![image](https://github.com/bmw-ece-ntust/multimedia-wireless-network/assets/133529935/6ba56e0b-b42c-4cc9-bb04-a1912130eff2)


## My Results

si




